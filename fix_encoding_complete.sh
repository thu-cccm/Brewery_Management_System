#!/bin/bash
# 完整的中文乱码修复脚本

BASE="/Users/4paradidm/Desktop/WORK/bbs/wine/Brewery_Management_System"

echo "开始修复中文乱码..."

# 修复所有Java文件
find "$BASE/ruoyi-admin/src/main/java/com/jiuchang/system" -name "*Brew*.java" -type f | while read file; do
    # 使用Perl进行UTF-8安全的替换
    perl -i -CSD -pe '
        s/åŽŸæ–™ä¿¡æ\x81¯/原料信息/g;
        s/é…'\''å"ç§ç±»/酒品种类/g;
        s/é…'\''æ–¹æ¨¡æ¿¿/配方模板/g;
        s/é…'\''æ–¹æ˜Žç»†/配方明细/g;
        s/åº"å˜å˜åŠ¨/库存变动/g;
        s/ç"Ÿäº§è®¡å'\''/生产计划/g;
        s/ç"Ÿäº§æ‰¹æ¬¡/生产批次/g;
        s/æ‰¹æ¬¡åŽŸæ–™/批次原料/g;
        s/ç"Ÿäº§è¿‡ç¨‹/生产过程/g;
        s/è´¨æ£€æ ‡å‡†/质检标准/g;
        s/è´¨æ£€è®°å½•/质检记录/g;
        s/è´¨æ£€æŠ¥å'\''/质检报告/g;
        s/æˆæœ¬é¡¹/成本项/g;
        s/æ‰¹æ¬¡æˆæœ¬/批次成本/g;
        s/æˆæœ¬ç»Ÿè®¡/成本统计/g;
        s/åˆ—è¡¨/列表/g;
        s/åŠ é"/新增/g;
        s/ä¿®æ"¹/修改/g;
        s/åˆ é"/删除/g;
        s/å¯¼å‡º/导出/g;
        s/æŸ¥è¯¢/查询/g;
        s/æ•°æ®/数据/g;
    ' "$file"
done

echo "✓ Java文件修复完成"

# 修复Vue和JS文件
find "$BASE/ruoyi-ui/src" \( -name "*.vue" -o -name "*.js" \) -type f | grep -i brew | while read file; do
    perl -i -CSD -pe '
        s/åŽŸæ–™ä¿¡æ\x81¯/原料信息/g;
        s/é…'\''å"ç§ç±»/酒品种类/g;
        s/é…'\''æ–¹æ¨¡æ¿¿/配方模板/g;
        s/é…'\''æ–¹æ˜Žç»†/配方明细/g;
        s/åº"å˜å˜åŠ¨/库存变动/g;
        s/ç"Ÿäº§è®¡å'\''/生产计划/g;
        s/ç"Ÿäº§æ‰¹æ¬¡/生产批次/g;
        s/æ‰¹æ¬¡åŽŸæ–™/批次原料/g;
        s/ç"Ÿäº§è¿‡ç¨‹/生产过程/g;
        s/è´¨æ£€æ ‡å‡†/质检标准/g;
        s/è´¨æ£€è®°å½•/质检记录/g;
        s/è´¨æ£€æŠ¥å'\''/质检报告/g;
        s/æˆæœ¬é¡¹/成本项/g;
        s/æ‰¹æ¬¡æˆæœ¬/批次成本/g;
        s/æˆæœ¬ç»Ÿè®¡/成本统计/g;
    ' "$file"
done

echo "✓ Vue/JS文件修复完成"
echo ""
echo "所有文件修复完成！"

